# version isn't needed as of 2020 for docker compose CLI. 
# All 2.x and 3.x features supported
#version: '3.9'

services:
  zookeeper: # docker run -it --rm --name zookeeper -p 2181:2181 -p 2888:2888 -p 3888:3888 quay.io/debezium/zookeeper:2.0
    image: quay.io/debezium/zookeeper:2.0
    ports:
      - '2181:2181'
      - '2888:2888'
      - '3888:3888'
  kafka:  # docker run -it --rm --name kafka -p 9092:9092 --link zookeeper:zookeeper quay.io/debezium/kafka:2.0
    image: quay.io/debezium/kafka:2.0
    ports:
      - '9092:9092'
    links:
      - "zookeeper:zookeeper"
  mysql: # $ docker run -it --rm --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=debezium -e MYSQL_USER=mysqluser -e MYSQL_PASSWORD=mysqlpw quay.io/debezium/example-mysql:2.0
    image: quay.io/debezium/example-mysql:2.0
    ports:
      - '3306:3306'
    environment:
      - MYSQL_ROOT_PASSWORD=debezium
      - MYSQL_USER=mysqluser
      - MYSQL_PASSWORD=mysqlpw
  connect: # docker run -it --rm --name connect -p 8083:8083 -e GROUP_ID=1 -e CONFIG_STORAGE_TOPIC=my_connect_configs -e OFFSET_STORAGE_TOPIC=my_connect_offsets -e STATUS_STORAGE_TOPIC=my_connect_statuses --link kafka:kafka --link mysql:mysql quay.io/debezium/connect:2.0
    image: quay.io/debezium/connect:2.0
    ports:
      - '8083:8083'
    environment:
      - GROUP_ID=1
      - CONFIG_STORAGE_TOPIC=my_connect_configs
      - OFFSET_STORAGE_TOPIC=my_connect_offsets
      - STATUS_STORAGE_TOPIC=my_connect_statuses
    links:
      - "kafka:kafka"
      - "mysql:mysql"

